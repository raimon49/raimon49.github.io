<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="JavaScript / Node製の静的ページジェネレータであるHexoを使い、GitHub Pagesで公開する手順について調べたのでまとめておく。 動機 調べた動機としては、 人気が上昇傾向で、特に中華圏での採用例が増えつつあるので使ってみたかった Node / npmの勉強用 日本語の解説記事では古いバージョンのものが多く、現行バージョン3.x系では変わってしまった手順が多々あった...">
        <meta name="keywords" content="GitHub, Hexo, JavaScript, Node, Pelican">
        <link rel="icon" href="https://raimon49.github.io/favicon.ico">
        <!-- Canonical -->
        <link rel="canonical" href="https://raimon49.github.io/2015/04/25/create-blog-with-hexo.html">
        <!-- /Canonical -->

        <title>静的ページジェネレータHexoで作成したブログをGitHub Pagesで公開する - Steel Dragon 14106</title>

        <!-- Stylesheets -->
        <link href="https://raimon49.github.io/theme/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://raimon49.github.io/theme/css/fonts.css" rel="stylesheet">
        <link href="https://raimon49.github.io/theme/css/nest.css" rel="stylesheet">
        <link href="https://raimon49.github.io/theme/css/pygment.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://raimon49.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Steel Dragon 14106 Full RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://raimon49.github.io/"><img class="mr20" src="https://raimon49.github.io/images/exchange32.png" alt="logo">Steel Dragon 14106</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="https://raimon49.github.io/categories.html">Categories</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">静的ページジェネレータHexoで作成したブログをGitHub Pagesで公開する</h1>
                      <p class="header-date">By <a href="https://raimon49.github.io/author/raimon.html">raimon</a>, 2015-04-25(土), in category <a href="https://raimon49.github.io/category/node.html">Node</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://raimon49.github.io/tag/github.html">GitHub</a>, <a href="https://raimon49.github.io/tag/hexo.html">Hexo</a>, <a href="https://raimon49.github.io/tag/javascript.html">JavaScript</a>, <a href="https://raimon49.github.io/tag/node.html">Node</a>, <a href="https://raimon49.github.io/tag/pelican.html">Pelican</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>JavaScript / Node製の静的ページジェネレータである<a href="https://github.com/hexojs/hexo">Hexo</a>を使い、<a href="https://pages.github.com/">GitHub Pages</a>で公開する手順について調べたのでまとめておく。</p>
<h2>動機</h2>
<p>調べた動機としては、</p>
<ul>
<li>人気が上昇傾向で、特に中華圏での採用例が増えつつあるので使ってみたかった</li>
<li>Node / npmの勉強用</li>
<li>日本語の解説記事では古いバージョンのものが多く、現行バージョン3.x系では変わってしまった手順が多々あった</li>
</ul>
<p>などが挙げられる。</p>
<p><a href="https://staticsitegenerators.net/">Static Site Generators</a>から引くと、GitHub Starの付けられた数が2015-04-25現在、3位に居る。このブログでも利用しているPelicanは抜かれて4位となっていた。</p>
<p><img src="/images/static-site-generators-sort-by-star.png" alt="GitHub Starによるソート順" width="590" height="483" style="width: 590px; max-width: 100%; height: auto;"></p>
<p>少なくとも2014年末時点ではPelicanの方が上だった筈だが、現在はHexoよりも上に居るのはGitHub上で人気のあるRuby製のJekyllとOctopressの2つだけとなっており、かなり勢いがあると言える。</p>
<h2>ブログの準備</h2>
<p>今回の環境は</p>
<ul>
<li>Node 0.12.2</li>
<li>npm 2.7.4</li>
</ul>
<p>を使っている。Node本体は0.10.x系でも問題無く動く筈である。</p>
<p>Hexoのオフィシャルなインストール方法は <code>npm install hexo-cli -g</code> だが、なるべくグローバル領域にインストールしない形で進めたいと考えて、実際にやってみたら可能だった。</p>
<p>Gitリポジトリとしたいディレクトリに <code>hexo-cli</code> をローカルインストールし、<code>$(npm bin)</code> で実行コマンドのあるパスを取得してブログを準備する。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>hexo

$<span class="w"> </span><span class="k">$(</span>npm<span class="w"> </span>bin<span class="k">)</span>/hexo<span class="w"> </span>init<span class="w"> </span>blog
INFO<span class="w">  </span>Copying<span class="w"> </span>data<span class="w"> </span>to<span class="w"> </span>~/works/git/hexo-use-sample/blog
INFO<span class="w">  </span>You<span class="w"> </span>are<span class="w"> </span>almost<span class="w"> </span><span class="k">done</span>!<span class="w"> </span>Don<span class="s1">&#39;t forget to run &#39;</span>npm<span class="w"> </span>install<span class="err">&#39;</span><span class="w"> </span>before<span class="w"> </span>you<span class="w"> </span>start<span class="w"> </span>blogging<span class="w"> </span>with<span class="w"> </span>Hexo!
</code></pre></div>

<p>引数で指定した <code>blog</code> という名前のディレクトリが生成されているので、そこに入って <code>package.json</code> に書かれた依存ライブラリをローカルインストールする。</p>
<p>これだけで、 <code>hexo serve</code> コマンドでローカルサーバが立ち上がり、 <code>4000</code> ポートにウェブブラウザからアクセスすると、Hello, World記事のあるブログ画面が表示される。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>blog
$<span class="w"> </span>npm<span class="w"> </span>install
$<span class="w"> </span><span class="k">$(</span>npm<span class="w"> </span>bin<span class="k">)</span>/hexo<span class="w"> </span>server
INFO<span class="w">  </span>Hexo<span class="w"> </span>is<span class="w"> </span>running<span class="w"> </span>at<span class="w"> </span>http://0.0.0.0:4000/.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>stop.
</code></pre></div>

<p><img alt="Hello, Worldブログ画面" src="/images/hexo-hello-world.png"></p>
<p>Hexoのインストールを確認したら、一旦 <code>Ctrl+C</code> でストップする。</p>
<h2>ブログのテーマをインストールする</h2>
<p>Hexoにも他のツールと同様に多数のテーマが用意されている。</p>
<p>テーマは<a href="https://github.com/hexojs/hexo/wiki/Themes">プロジェクトWikiページ</a>でリスト化されている。今回はこの中から<a href="https://github.com/ppoffice/hexo-theme-hueman">Hueman</a>というテーマをインストールした。</p>
<p>Hexoにおけるテーマのインストール方法は、ブログ内のディレクトリ <code>themes</code> 以下に、テーマのGitリポジトリを丸ごとクローンして入れるという原始的な手順らしい。これは <code>themes/theme-name/_config.yml</code> も評価して静的ページ生成するというHexoの設計も関係しているようだ。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git://github.com/ppoffice/hexo-theme-hueman<span class="w"> </span>themes/hueman
</code></pre></div>

<p>長期的に運用して行きたい場合は、<a href="http://japan.blogs.atlassian.com/2014/03/alternatives-to-git-submodule-git-subtree/">Git Subtree</a>による管理を検討すると良いだろう。Git Submoduleは純粋に外部リポジトリの参照であるため、テーマリポジトリ内の設定ファイル変更をコミットしておけないからだ。</p>
<p>テーマのGitリポジトリを取得したら、<code>blog/_config.yml</code> で指定してデザインを適用する。</p>
<div class="highlight"><pre><span></span><code><span class="gd">--- a/blog/_config.yml</span>
<span class="gi">+++ b/blog/_config.yml</span>
<span class="gu">@@ -3,11 +3,11 @@</span>
<span class="w"> </span>## Source: https://github.com/hexojs/hexo/

<span class="w"> </span># Site
<span class="gd">-title: Hexo</span>
<span class="gi">+title: Hexo Use Sample Blog</span>
<span class="w"> </span>subtitle:
<span class="w"> </span>description:
<span class="gd">-author: John Doe</span>
<span class="gd">-language:</span>
<span class="gi">+author: raimon</span>
<span class="gi">+language: en</span>
<span class="w"> </span>timezone:

<span class="w"> </span># URL
<span class="gu">@@ -62,9 +62,9 @@ pagination_dir: page</span>
<span class="w"> </span># Extensions
<span class="w"> </span>## Plugins: http://hexo.io/plugins/
<span class="w"> </span>## Themes: http://hexo.io/themes/
<span class="gd">-theme: landscape</span>
<span class="gi">+theme: hueman</span>
</code></pre></div>

<p>Hexoの特徴として、中華圏のユーザーコミュニティが非常に厚く、テーマもデフォルトで言語設定が中国語となっているものが多い。</p>
<p>よって <code>language: en</code> としないと、メニューが中国語になってしまうテーマが幾つも見受けられた。Huemanテーマも同様だった。</p>
<p>この状態で先ほどと同様にローカルサーバを立ち上げると、ブログのデザインが変わっていることが確認できる。</p>
<h2>記事を投稿する</h2>
<p>テーマの設定が完了したので、記事を作成してみる。</p>
<p>自動生成されたHello, World記事はもう不要になるため消してしまい、<code>hexo new</code> コマンドで自分の記事を作成する。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>git<span class="w"> </span>rm<span class="w"> </span>source/_posts/hello-world.md
rm<span class="w"> </span><span class="s1">&#39;blog/source/_posts/hello-world.md&#39;</span>
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Remove hello world post&#39;</span>

$<span class="w"> </span><span class="k">$(</span>npm<span class="w"> </span>bin<span class="k">)</span>/hexo<span class="w"> </span>new<span class="w"> </span><span class="s2">&quot;hello-my-post&quot;</span>
INFO<span class="w">  </span>Created:<span class="w"> </span>/path/to/repo/hexo-use-sample/blog/source/_posts/hello-my-post.md
</code></pre></div>

<p>ローカルサーバで確認してOKだったら <code>git commit</code> する。</p>
<h2>ブログをGitHub Pagesで公開する</h2>
<p>Hexoは設定ファイルでブログの公開先としてGitリポジトリが指定できる。</p>
<p>この辺りはバージョン3.x系では別プラグインとして切り離されており、インストールが必要である。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>hexo-deployer-git<span class="w"> </span>--save
</code></pre></div>

<p>今回は次のような設定で公開することにした。</p>
<ul>
<li>リポジトリ名: <code>hexo-use-sample</code></li>
<li>ブランチ名: <code>gh-pages</code><ul>
<li><code>master</code> ブランチでは記事の生成元となるMarkdown文書などを管理</li>
</ul>
</li>
<li>URL: <code>http://{username}.github.io/hexo-use-sample/</code></li>
</ul>
<p>実際に <code>blog/_config.yml</code> に反映すると以下のようになる。<code>type: git</code> となっている点は注意（古いバージョンでは <code>type: github</code> になっている）。</p>
<div class="highlight"><pre><span></span><code><span class="gd">--- a/blog/_config.yml</span>
<span class="gi">+++ b/blog/_config.yml</span>
<span class="gu">@@ -12,8 +12,8 @@ timezone:</span>

<span class="w"> </span># URL
<span class="w"> </span>## If your site is put in a subdirectory, set url as &#39;http://yoursite.com/child&#39; and root as &#39;/child/&#39;
<span class="gd">-url: http://yoursite.com</span>
<span class="gd">-root: /</span>
<span class="gi">+url: http://raimon49.github.io/hexo-use-sample/</span>
<span class="gi">+root: /hexo-use-sample/</span>
<span class="w"> </span>permalink: :year/:month/:day/:title/
<span class="w"> </span>permalink_defaults:

<span class="gu">@@ -67,4 +67,6 @@ theme: hueman</span>
<span class="w"> </span># Deployment
<span class="w"> </span>## Docs: http://hexo.io/docs/deployment.html
<span class="w"> </span>deploy:
<span class="gd">-  type:</span>
<span class="gi">+  type: git</span>
<span class="gi">+  repo: git@github.com:raimon49/hexo-use-sample.git</span>
<span class="gi">+  branch: gh-pages</span>
</code></pre></div>

<p>また、グローバルではなくローカルに <code>hexo-cli</code> をインストールした関係で、コマンド実行時に都度 <code>$(npm bin)</code> で実行パスを取得していたが、<code>npm-scripts</code> に定義して、覚えておかなくて良いようにする。</p>
<div class="highlight"><pre><span></span><code><span class="gd">--- a/blog/package.json</span>
<span class="gi">+++ b/blog/package.json</span>
<span class="gu">@@ -5,15 +5,21 @@</span>
<span class="w"> </span>  &quot;hexo&quot;: {
<span class="w"> </span>    &quot;version&quot;: &quot;3.0.1&quot;
<span class="w"> </span>  },
<span class="gi">+  &quot;scripts&quot;: {</span>
<span class="gi">+    &quot;start&quot;: &quot;hexo server&quot;,</span>
<span class="gi">+    &quot;create&quot;: &quot;hexo new&quot;,</span>
<span class="gi">+    &quot;deploy&quot;: &quot;hexo deploy -g&quot;</span>
<span class="gi">+  },</span>
<span class="w"> </span>  &quot;dependencies&quot;: {
<span class="w"> </span>    &quot;hexo&quot;: &quot;^3.0.0&quot;,
<span class="gi">+    &quot;hexo-deployer-git&quot;: &quot;0.0.4&quot;,</span>
<span class="w"> </span>    &quot;hexo-generator-archive&quot;: &quot;^0.1.0&quot;,
</code></pre></div>

<p>参考記事として<a href="http://qiita.com/axross/items/a2a0d148e40b66074858">npm-scriptsについて</a>と<a href="http://qiita.com/Jxck_/items/efaff21b977ddc782971">npm で依存もタスクも一元化する</a>を挙げておく。</p>
<p>これで <code>package.json</code> の実行タスクが定義された。その中から <code>deploy</code> を実行すると、<code>master</code> ブランチの内容から静的ページが生成されて <code>gh-pages</code> ブランチとしてpushまで行き、自動的にGitHub Pagesで公開される。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>npm<span class="w"> </span>run
Lifecycle<span class="w"> </span>scripts<span class="w"> </span>included<span class="w"> </span><span class="k">in</span><span class="w"> </span>hexo-site:
<span class="w">  </span>start
<span class="w">    </span>hexo<span class="w"> </span>server

available<span class="w"> </span>via<span class="w"> </span><span class="sb">`</span>npm<span class="w"> </span>run-script<span class="sb">`</span>:
<span class="w">  </span>create
<span class="w">    </span>hexo<span class="w"> </span>new
<span class="w">  </span>deploy
<span class="w">    </span>hexo<span class="w"> </span>deploy<span class="w"> </span>-g

$<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>deploy

&gt;<span class="w"> </span>hexo-site@0.0.0<span class="w"> </span>deploy<span class="w"> </span>/home/raimon49/works/git/hexo-use-sample/blog
&gt;<span class="w"> </span>hexo<span class="w"> </span>deploy<span class="w"> </span>-g

Branch<span class="w"> </span>master<span class="w"> </span><span class="nb">set</span><span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>track<span class="w"> </span>remote<span class="w"> </span>branch<span class="w"> </span>gh-pages<span class="w"> </span>from<span class="w"> </span>git@github.com:raimon49/hexo-use-sample.git.
INFO<span class="w">  </span>Deploy<span class="w"> </span><span class="k">done</span>:<span class="w"> </span>git
</code></pre></div>

<p>また、新しい記事の作成も次回からは <code>npm-scripts</code> を使って可能になった。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>create<span class="w"> </span><span class="s2">&quot;hexo-dependency</span>
</code></pre></div>

<p>今回公開した記事は次のようなデザイン・内容になった。</p>
<ul>
<li><a href="http://raimon49.github.io/hexo-use-sample/2015/04/25/hello-my-post/">Hello my post</a></li>
<li><a href="http://raimon49.github.io/hexo-use-sample/2015/04/25/hexo-dependency/">hexo-dependency</a></li>
</ul>
<p>タグを複数指定したい時は、記事生成元のMarkdownで <code>tags: [GitHub, Hexo]</code> のように <code>[]</code> で囲って並べると可能なようだ。</p>
<h2>まとめと感想</h2>
<ul>
<li>Hexoはグローバル領域にツールをインストールしなくても使えると分かった</li>
<li>テーマインストールの項でも触れたが、中華圏のユーザーコミュニティが非常に活発で、詰まってFAQなどで情報を探した時にも実感した</li>
<li>記事のMarkdownテンプレートを作ってくれたり、デプロイまで面倒を見てくれるコマンドラインツールの機能は便利だった</li>
<li>ブログに特化しており、インストールしてすぐに画面を確認できる点も良い<ul>
<li>このお手軽さから、Static Site Generatorsでもっと上に行くかも知れないと感じた</li>
</ul>
</li>
<li>ページ生成にやや時間のかかる印象を持った<ul>
<li>Pelicanだと一瞬なので、プログラミング言語や設計の違いに拠るものか、今も絶賛改善中なのか、自分の知識では良く分からなかった</li>
</ul>
</li>
</ul>


    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'steeldragon14106';
                var disqus_identifier = '2015/04/25/create-blog-with-hexo.html';
                var disqus_url = 'https://raimon49.github.io/2015/04/25/create-blog-with-hexo.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://raimon49.github.io/archives.html">Archives</a></li>
                            <li><a href="https://raimon49.github.io/tags.html">Tags</a></li>
                            <li><a href="https://raimon49.github.io/authors.html">Authors</a></li>
                            <li><a href="https://raimon49.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://github.com/raimon49" target="_blank">GitHub</a></li>
                            <li><a href="https://twitter.com/raimon49" target="_blank">Twitter</a></li>
                            <li><a href="https://www.last.fm/user/raimon_49" target="_blank">Last.fm</a></li>
                            <li><a href="http://sangoukan.xrea.jp/" target="_blank">Website</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="https://raimon49.github.io/my-portfolio/" target="_blank">Information about raimon</a></li>
                            <li><a href="https://blog.getpelican.com/" target="_blank">Pelican</a></li>
                            <li><a href="https://www.python.org/" target="_blank">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/" target="_blank">Jinja2</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; raimon 2014-2019</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>